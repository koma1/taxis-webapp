<beans:beans xmlns="http://www.springframework.org/schema/security"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
	http://www.springframework.org/schema/security
	http://www.springframework.org/schema/security/spring-security-5.3.xsd">
    
    <!-- ROLE_ANONYMOUSE - только зашел
		ROLE_UNAUTHORIZED - ввел капчу (но не прилогинен)
		
		ROLE_AUTHORIZED - прилогинен
		
		ROLE_ADMIN (Entity modificator save.action, remove.action asd via REST)
		
		ROLE_REST -->
		
	<beans:bean id="defaultHttpFirewall" class="org.springframework.security.web.firewall.DefaultHttpFirewall"/>
	<http-firewall ref="defaultHttpFirewall"/>
    
    <global-method-security pre-post-annotations="enabled"/>
    <http auto-config="true">
      <!-- REST interceptors -->
        <intercept-url pattern="/rest/**" access="hasRole('ROLE_REST')" method="GET"/>
        <intercept-url pattern="/rest/**" access="hasRole('ROLE_DATA_MANAGER')" method="POST"/>
        <intercept-url pattern="/rest/**" access="hasRole('ROLE_DATA_MANAGER')" method="PUT"/>
        <intercept-url pattern="/rest/**" access="hasRole('ROLE_DATA_MANAGER')" method="DELETE"/>
      <!-- Actions interceptors -->  
        <intercept-url pattern="/taxis/**" access="hasRole('ROLE_AUTHORIZED')" />
        <intercept-url pattern="/cities/**" access="hasRole('ROLE_AUTHORIZED')" />

        <form-login
            login-page="/login"
            authentication-failure-url="/login?error"
            username-parameter="username"
            password-parameter="password"/>
            
        <logout logout-url="/logout" logout-success-url="/login"/>
    </http>
    
    <authentication-manager erase-credentials="false">
        <authentication-provider>
            <user-service>
                <user name="admin" password="{noop}admin" authorities="ROLE_AUTHORIZED,ROLE_ADMIN,ROLE_REST" />
                <user name="user"  password="{noop}user" authorities="ROLE_AUTHORIZED,ROLE_USER"/>
            </user-service>
        </authentication-provider>
    </authentication-manager>
 
</beans:beans>